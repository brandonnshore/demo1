import{c as ae,j as e,S as ze,u as he,a as Ae,d as fe,b as re,p as Le}from"./index-BQMf4Voa.js";import{r as a,R as Fe,e as Te,f as Ue,L as Ee,h as Re}from"./react-vendor-Byl6S4M9.js";import{S as Me,L as Pe,I as ke,T as Oe}from"./canvas-vendor-CLiMLpzp.js";import{X as pe}from"./x-DEmYqfxJ.js";import{t as $e,a as Be}from"./analytics-o4OqUApf.js";import"./auth-vendor-Cg5HAGal.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=ae("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=ae("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=ae("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=ae("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),ve=a.forwardRef(({tshirtColor:I="white",artworks:h=[],onArtworkPositionChange:T,onArtworkDelete:F,view:k="front"},z)=>{const[v,C]=a.useState(null),[R,M]=a.useState([]),[A,L]=a.useState(null),[O]=a.useState(null),E=a.useRef([]),x=a.useRef(null),_=a.useRef(null),N=a.useRef({front:null,back:null,neck:null}),q=a.useRef("front"),[X,Y]=a.useState({width:550,height:650});a.useImperativeHandle(z,()=>({downloadImage:()=>{if(_.current){const n=_.current.toDataURL({pixelRatio:3,mimeType:"image/png",quality:1}),r=document.createElement("a");r.download="tshirt-design.png",r.href=n,document.body.appendChild(r),r.click(),document.body.removeChild(r)}},getThumbnail:()=>_.current?_.current.toDataURL({pixelRatio:1,mimeType:"image/png",quality:.8}):null,captureImage:()=>_.current?_.current.toDataURL({pixelRatio:2,mimeType:"image/png",quality:.9}):null,getThumbnailBlob:async()=>{if(_.current){const n=_.current.toDataURL({pixelRatio:1,mimeType:"image/png",quality:.8});return await(await fetch(n)).blob()}return null}}));const ne=n=>{const r=n.toLowerCase();return r==="navy"?{front:"/assets/navy-front.png",back:"/assets/navy-back.png",neck:"/assets/navy-neck.png"}:r==="black"?{front:"/assets/black-front.png",back:"/assets/black-back.png",neck:"/assets/black-neck.png"}:{front:"/assets/blank-tshirt.png",back:"/assets/back-tshirt.jpeg",neck:"/assets/neck-tshirt.jpeg"}};a.useEffect(()=>{const n=d=>new Promise(u=>{const m=new window.Image;m.src=d,m.crossOrigin="anonymous",m.onload=()=>u(m),m.onerror=()=>u(m)}),r=ne(I);Promise.all([n(r.front),n(r.back),n(r.neck)]).then(([d,u,m])=>{N.current.front=d,N.current.back=u,N.current.neck=m;const c=k==="neck"?m:k==="back"?u:d;if(k==="neck"){const b=c.width/c.height,P=1600,D=950;let f=P,S=f/b;S<D&&(S=D,f=S*b),Y({width:f,height:S})}else{const b=c.width/c.height,P=600,D=700;let f=P,S=P/b;if(S>D&&(S=D,f=D*b),k==="back"){const $=I?.toLowerCase()||"";$==="white"||$===""?(f=f*1.1,S=S*1.1):$==="navy"&&(f=f*1.02,S=S*1.02)}Y({width:f,height:S})}C(c)})},[I,k]),a.useEffect(()=>{if(k===q.current)return;const n=k==="neck"?N.current.neck:k==="back"?N.current.back:N.current.front;if(n){if(k==="neck"){const r=n.width/n.height,d=1600,u=950;let m=d,c=m/r;c<u&&(c=u,m=c*r),Y({width:m,height:c})}else{const u=n.width/n.height;let m=600,c=600/u;if(c>700&&(c=700,m=700*u),k==="back"){const b=I?.toLowerCase()||"";b==="white"||b===""?(m=m*1.1,c=c*1.1):b==="navy"&&(m=m*1.02,c=c*1.02)}Y({width:m,height:c})}C(n),q.current=k}},[k]),a.useEffect(()=>{const n=r=>{if((r.key==="Delete"||r.key==="Backspace")&&A&&F){const d=parseInt(A.split("-")[1]);isNaN(d)||(F(d),L(null))}};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[A,F]);const W=a.useRef(new Map);a.useEffect(()=>{if(h.length===0){M([]),L(null),E.current=[];return}(async()=>{const r=h.map(d=>{const u=W.current.get(d.url);return u?Promise.resolve(u):new Promise((m,c)=>{const b=new window.Image;b.src=d.url,b.crossOrigin="anonymous",b.onload=()=>{W.current.set(d.url,b),m(b)},b.onerror=c})});try{const d=await Promise.all(r);M(d),E.current=new Array(d.length).fill(null);const u=h[h.length-1];u&&!u.position&&L(`artwork-${h.length-1}`)}catch(d){console.error("Failed to load artworks:",d)}})()},[h]),a.useEffect(()=>{if(A&&x.current){const n=parseInt(A.split("-")[1]),r=E.current[n];r&&(x.current.nodes([r]),x.current.getLayer()?.batchDraw())}},[A]);const K=n=>{const r=E.current[n];r&&T&&T({x:r.x(),y:r.y(),scaleX:r.scaleX(),scaleY:r.scaleY(),rotation:r.rotation()},n)},y=n=>{const r=n.target===n.target.getStage(),d=n.target.image===v;(r||d)&&L(null)};return O?e.jsx("div",{className:"relative w-full h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-500 mb-2",children:O}),e.jsx("p",{className:"text-xs text-gray-400",children:"Using fallback preview"})]})}):e.jsxs("div",{className:"relative w-full h-full flex items-center justify-center overflow-hidden",children:[R.length>0&&A&&e.jsx("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 bg-black/80 text-white text-xs px-4 py-2 rounded-full z-10",children:"Drag to move â€¢ Corners to resize â€¢ Rotate to spin â€¢ Click away to finish"}),R.length>0&&!A&&e.jsx("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 bg-gray-800/60 text-white text-xs px-4 py-2 rounded-full z-10",children:"Click artwork to edit position and size"}),e.jsx(Me,{ref:_,width:X.width,height:X.height,onMouseDown:y,onTouchStart:y,children:e.jsxs(Pe,{children:[v&&e.jsx(ke,{image:v,x:0,y:0,width:X.width,height:X.height,onClick:()=>L(null),onTap:()=>L(null),...k==="neck"?{crop:{x:0,y:0,width:v.width,height:v.height}}:{}}),R.map((n,r)=>{const d=h[r];if(!d)return null;const u=250,m=250,c=n.width/n.height;let b=u,P=u/c;return P>m&&(P=m,b=m*c),e.jsxs(Fe.Fragment,{children:[e.jsx(ke,{ref:D=>{E.current[r]=D},image:n,x:d.position?.x??(k==="neck"?750:200+r*20),y:d.position?.y??(k==="neck"?500:250+r*20),width:b,height:P,scaleX:d.position?.scaleX??1,scaleY:d.position?.scaleY??1,rotation:d.position?.rotation??0,draggable:!0,dragBoundFunc:D=>{let f;k==="neck"?f={minX:520,maxX:1080,minY:560,maxY:710}:k==="back"?f={minX:140,maxX:510,minY:100,maxY:550}:f={minX:80,maxX:470,minY:100,maxY:550};const S=E.current[r],$=S?.width()||0,Q=S?.height()||0,oe=S?.scaleX()||1,V=S?.scaleY()||1,Z=$*oe,H=Q*V;let J=D.x,B=D.y;return J<f.minX&&(J=f.minX),J+Z>f.maxX&&(J=f.maxX-Z),B<f.minY&&(B=f.minY),B+H>f.maxY&&(B=f.maxY-H),{x:J,y:B}},onClick:()=>L(`artwork-${r}`),onTap:()=>L(`artwork-${r}`),onDragEnd:()=>K(r),onTransformEnd:()=>K(r)}),A===`artwork-${r}`&&e.jsx(Oe,{ref:x,keepRatio:!0,boundBoxFunc:(D,f)=>f.width<50||f.height<50||f.width>400||f.height>400?D:f,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],rotateEnabled:!0,borderStroke:"#000000",borderStrokeWidth:2,anchorSize:12,anchorStroke:"#000000",anchorFill:"#ffffff",anchorCornerRadius:6})]},`artwork-${r}`)})]})})]})});ve.displayName="TShirtCanvas";function We({isOpen:I,onClose:h,onSave:T,isUpdating:F=!1,currentName:k=""}){const[z,v]=a.useState(k),[C,R]=a.useState(!1),[M,A]=a.useState(!1),[L,O]=a.useState(""),E=async()=>{if(!z.trim()){O("Please enter a name for your design");return}R(!0),O("");try{await T(z.trim()),A(!0),setTimeout(()=>{h(),A(!1),v("")},1500)}catch(_){O(_.message||"Failed to save design"),R(!1)}},x=()=>{C||(h(),v(""),O(""),A(!1))};return I?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold",children:F?"Update Design":"Save Design"}),!C&&e.jsx("button",{onClick:x,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(pe,{size:24})})]}),e.jsx("div",{className:"p-6",children:M?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4",children:e.jsx(ye,{size:32,className:"text-green-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:F?"Design Updated!":"Design Saved!"}),e.jsxs("p",{className:"text-gray-600",children:['Your design "',z,'" has been saved to your dashboard']})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"design-name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Design Name"}),e.jsx("input",{id:"design-name",type:"text",value:z,onChange:_=>v(_.target.value),onKeyPress:_=>_.key==="Enter"&&E(),placeholder:"e.g., Summer Collection Tee",className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent",disabled:C,autoFocus:!0}),L&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:L})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," Give your design a memorable name so you can easily find it later!"]})})]})}),!M&&e.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:x,disabled:C,className:"flex-1 px-4 py-3 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:E,disabled:C||!z.trim(),className:"flex-1 px-4 py-3 bg-black text-white rounded-md hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:C?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Saving..."]}):F?"Update Design":"Save Design"})]})]})}):null}function Ve({message:I,type:h="success",onClose:T,duration:F=3e3}){a.useEffect(()=>{const v=setTimeout(()=>{T()},F);return()=>clearTimeout(v)},[T,F]);const k={success:e.jsx(ye,{size:20}),error:e.jsx(pe,{size:20}),info:e.jsx(ze,{size:20})},z={success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500"};return e.jsxs("div",{className:"fixed bottom-8 right-8 z-50 animate-slideUp",role:"alert",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden max-w-md",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4",children:[e.jsx("div",{className:`${z[h]} text-white p-2 rounded-xl flex-shrink-0`,children:k[h]}),e.jsx("p",{className:"text-gray-900 font-medium flex-1",children:I}),e.jsx("button",{onClick:T,className:"text-gray-400 hover:text-gray-600 transition-colors p-1","aria-label":"Close",children:e.jsx(pe,{size:18})})]}),e.jsx("div",{className:"h-1 bg-gray-100",children:e.jsx("div",{className:`h-full ${z[h]} transition-all`,style:{animation:`shrink ${F}ms linear`,transformOrigin:"left"}})})]}),e.jsx("style",{children:`
        @keyframes slideUp {
          from {
            transform: translateY(100px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }

        @keyframes shrink {
          from {
            width: 100%;
          }
          to {
            width: 0%;
          }
        }
      `})]})}function He({product:I,variants:h}){const T=Te(),F=he(s=>s.addItem),k=he(s=>s.updateItem),z=he(s=>s.getItem),v=a.useRef(null),{isAuthenticated:C}=Ae(),[R]=Ue(),[M,A]=a.useState(null),[L,O]=a.useState(null),E=a.useRef(null);a.useEffect(()=>{$e(I.title)},[]);const[x,_]=a.useState(""),[N,q]=a.useState(""),[X,Y]=a.useState(null),[ne]=a.useState(""),[W,K]=a.useState(1),[y,n]=a.useState("front"),[r,d]=a.useState([]),[u,m]=a.useState(null),[c,b]=a.useState([]),P=()=>y==="front"?r:y==="neck"?u?[u]:[]:y==="back"?c:[],D=P()[0]||null,[f,S]=a.useState(!1),[$,Q]=a.useState(""),[oe,V]=a.useState(!1),[Z,H]=a.useState(""),B=(()=>{let s=12.98;const t=r.length>0,o=c.length>0,l=u!==null;return[t,o].filter(Boolean).length===2&&(s+=5),l&&(s+=1),s})(),ie=[...new Set(h.map(s=>s.color))],we=ie.includes("Navy")?ie:[...ie,"Navy"],je=[...new Set(h.map(s=>s.size))].sort((s,t)=>{const o=["S","M","L","XL","2XL","3XL"];return o.indexOf(s)-o.indexOf(t)});a.useEffect(()=>{if(x&&N){const s=h.find(t=>t.color===x&&t.size===N);Y(s||null)}},[x,N,h]),a.useEffect(()=>{const s=R.get("designId");s&&C&&h.length>0&&E.current!==s&&(E.current=s,Ne(s))},[R,C,h]),a.useEffect(()=>{const s=R.get("editCartItem");if(s){const t=z(s);t&&(O(s),_(t.variantColor),q(t.variantSize),K(t.quantity),t.customization&&(t.customization.frontArtworks&&d(t.customization.frontArtworks),t.customization.backArtworks&&b(t.customization.backArtworks),t.customization.neckArtwork&&m(t.customization.neckArtwork)))}},[R,z]);const Ne=async s=>{try{const t=await fe.getById(s);console.log("[LOAD] Full design object:",JSON.stringify(t,null,2)),A(t.id),Q(t.name);const o=t.artwork_ids||[],l=t.artwork_urls||{},i=p=>p?p.startsWith("http")?p:`http://localhost:3001${p}`:"";let g=0;if(t.design_data){if(t.design_data.front&&t.design_data.front.length>0){const p=t.design_data.front.map(U=>{const G=o[g],ge=G?i(l[G]):"";return g++,{url:ge||"",position:U,assetId:G}});d(p)}if(t.design_data.back&&t.design_data.back.length>0){const p=t.design_data.back.map(U=>{const G=o[g],ge=G?i(l[G]):"";return g++,{url:ge||"",position:U,assetId:G}});b(p)}if(t.design_data.neck&&t.design_data.neck.length>0){const p=o[g],U=p?i(l[p]):"";m({url:U||"",position:t.design_data.neck[0],assetId:p})}}console.log("[LOAD] Design variant_id:",t.variant_id),console.log("[LOAD] Design variant_color:",t.variant_color),console.log("[LOAD] Design variant_size:",t.variant_size),console.log("[LOAD] Design data color/size:",t.design_data?.selectedColor,t.design_data?.selectedSize);let w=null,j=null;if(t.design_data?.selectedColor){console.log("[LOAD] Using color from design_data (highest priority):",t.design_data.selectedColor),w=t.design_data.selectedColor,j=t.design_data.selectedSize||"M";const p=h.find(U=>U.color===w&&U.size===j);p?(console.log("[LOAD] Found matching variant for design_data color:",p),Y(p)):console.log("[LOAD] No variant found for color:",w,"(UI-only color like Navy)")}else if(t.variant_id){let p=h.find(U=>U.id===t.variant_id);console.log("[LOAD] Found variant by ID:",p),!p&&t.variant_color&&t.variant_size&&(console.log("[LOAD] Variant ID not found, trying color/size lookup:",t.variant_color,t.variant_size),p=h.find(U=>U.color===t.variant_color&&U.size===t.variant_size),console.log("[LOAD] Found variant by color/size:",p)),p?(console.log("[LOAD] Setting color/size/variant from variant:",p.color,p.size),w=p.color,j=p.size,Y(p)):t.variant_color&&(console.log("[LOAD] No variant found, using color from JOIN:",t.variant_color),w=t.variant_color,j=t.variant_size)}w&&(_(w),q(j||"M"))}catch(t){console.error("Error loading design:",t),alert("Failed to load design")}},le=async s=>{const t=s.target.files?.[0];if(t)try{if(t.type==="image/png"||t.type==="image/jpeg"){const i=await t.arrayBuffer(),g=await Se(i,t.type);if(g&&g<300&&!window.confirm(`Warning: This image has a DPI of ${g}, which is below the required 300 DPI for high-quality DTG printing. The print quality may be poor.

Do you want to upload it anyway?`)){s.target.value="";return}}const l={url:URL.createObjectURL(t),position:null,assetId:void 0};if(y==="front")if(r.length<4){const i=r.length;d([...r,l]),re.uploadFile(t).then(g=>{d(w=>{const j=[...w];return j[i]&&(j[i]={url:`http://localhost:3001${g.file_url}`,position:j[i].position,assetId:g.id}),j})}).catch(g=>console.error("Upload failed:",g))}else{alert("Maximum 4 artworks allowed on front view"),s.target.value="";return}else if(y==="neck"){if(u){alert("Only 1 artwork allowed on neck view. Remove existing artwork first."),s.target.value="";return}m(l),re.uploadFile(t).then(i=>{m(g=>({url:`http://localhost:3001${i.file_url}`,position:g?.position||null,assetId:i.id}))}).catch(i=>console.error("Upload failed:",i))}else if(y==="back")if(c.length<4){const i=c.length;b([...c,l]),re.uploadFile(t).then(g=>{b(w=>{const j=[...w];return j[i]&&(j[i]={url:`http://localhost:3001${g.file_url}`,position:j[i].position,assetId:g.id}),j})}).catch(g=>console.error("Upload failed:",g))}else{alert("Maximum 4 artworks allowed on back view"),s.target.value="";return}s.target.value=""}catch(o){console.error("File upload failed:",o),alert("Failed to upload file"),s.target.value=""}},Se=async(s,t)=>{const o=new DataView(s);try{if(t==="image/png"){let l=8;for(;l<o.byteLength;){const i=o.getUint32(l);if(String.fromCharCode(o.getUint8(l+4),o.getUint8(l+5),o.getUint8(l+6),o.getUint8(l+7))==="pHYs"){const w=o.getUint32(l+8);if(o.getUint8(l+16)===1)return Math.round(w/39.3701)}l+=i+12}}else if(t==="image/jpeg"){let l=2;for(;l<o.byteLength;){if(o.getUint16(l)===65504){const w=o.getUint8(l+11),j=o.getUint16(l+12);if(w===1)return j;if(w===2)return Math.round(j*2.54);break}const g=o.getUint16(l+2);l+=g+2}}}catch(l){console.error("Error reading DPI:",l)}return null},Ce=()=>{v.current&&v.current.downloadImage&&v.current.downloadImage()},_e=async()=>{if(!C){T("/login",{state:{from:window.location.pathname+window.location.search}});return}if(M&&$){try{await be($),H("Design updated successfully!"),V(!0),setTimeout(()=>V(!1),3e3)}catch(s){console.error("Error updating design:",s),alert("Failed to update design")}return}S(!0)},be=async s=>{try{const t={front:r.map(i=>i.position),back:c.map(i=>i.position),neck:u?[u.position]:[],selectedColor:x,selectedSize:N||"M"},o=[...r.filter(i=>i.assetId).map(i=>i.assetId),...c.filter(i=>i.assetId).map(i=>i.assetId),...u?.assetId?[u.assetId]:[]];let l="";if(v.current&&v.current.getThumbnailBlob)try{const i=await v.current.getThumbnailBlob();if(i){const g=new File([i],"thumbnail.png",{type:"image/png"});l=(await re.uploadFile(g)).file_url}}catch(i){console.error("Failed to capture thumbnail:",i)}if(M){const i=N||"M",g=X||(x?h.find(w=>w.color===x&&w.size===i):null);console.log("[SAVE] Updating design with variant:",{variantId:g?.id,color:x,size:N,variant:g}),await fe.update(M,{name:s,variantId:g?.id,designData:t,artworkIds:o,thumbnailUrl:l}),Q(s)}else{const i=N||"M",g=X||(x?h.find(j=>j.color===x&&j.size===i):null);console.log("[SAVE] Saving new design with variant:",{variantId:g?.id,color:x,size:N,variant:g});const w=await fe.save({name:s,productId:I.id,variantId:g?.id,designData:t,artworkIds:o,thumbnailUrl:l});A(w.id),Q(s),Be(s)}}catch(t){throw console.error("Error saving design:",t),t}},Ie=()=>{if(!x||!N){H("Please select a color and size"),V(!0);return}let s;try{v.current&&v.current.captureImage&&(s=v.current.captureImage())}catch(l){console.error("Error capturing mockup:",l)}const t=X||{id:`temp-${x}-${N}`},o={id:L||`${t.id}-${Date.now()}`,variantId:t.id,productTitle:I.title,variantColor:x,variantSize:N,quantity:W,unitPrice:B,customization:{method:ne||"screen_print",frontArtworks:r,backArtworks:c,neckArtwork:u},mockupUrl:s};L?(k(L,o),H("Cart item updated successfully!")):(F(o),H("Added to cart successfully!")),V(!0),setTimeout(()=>{T("/cart")},1500)},[ce,De]=a.useState(!0),[de,ee]=a.useState(!1),[ue,te]=a.useState(!1),[me,se]=a.useState(!1);return a.useEffect(()=>{y==="neck"?(se(!0),ee(!1),te(!1)):y==="front"?(ee(!0),te(!1),se(!1)):y==="back"&&(te(!0),ee(!1),se(!1))},[y]),e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("div",{className:"border-b border-gray-200 bg-white",children:e.jsxs("div",{className:"relative px-6 py-1.5 flex items-center",children:[e.jsx("h1",{className:"text-sm font-bold",children:I.title}),e.jsx(Ee,{to:"/",className:"absolute left-1/2 -translate-x-1/2 text-lg font-bold hover:text-gray-600 transition-colors",children:"Raspberry"}),e.jsxs("div",{className:"ml-auto flex items-center gap-4",children:[e.jsx("button",{onClick:Ce,disabled:!D,title:"Download Design",className:`p-2 rounded-md transition-colors ${D?"text-gray-700 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"}`,children:e.jsx(Xe,{size:18})}),e.jsxs("button",{onClick:_e,className:"flex items-center gap-1.5 px-4 py-1.5 text-xs font-medium rounded-md transition-colors bg-black text-white hover:bg-gray-800",children:[e.jsx(Ye,{size:14}),M?"Update Design":"Save Design"]}),e.jsxs("div",{className:"text-sm font-normal",children:["from $",12.98.toFixed(2)]})]})]})}),e.jsxs("div",{className:"grid lg:grid-cols-[1fr_400px] h-[calc(100vh-40px)]",children:[e.jsxs("div",{className:"bg-white flex flex-col relative h-full overflow-hidden",children:[e.jsx("div",{className:`absolute inset-0 flex items-center justify-center ${y==="neck"?"pt-0 pb-0 px-0":"pt-2 pb-16 px-6"}`,children:e.jsx(ve,{ref:v,tshirtColor:x,artworks:P(),onArtworkPositionChange:(s,t)=>{if(y==="front"){const o=[...r];o[t]={...o[t],position:s},d(o)}else if(y==="neck"&&u)m({...u,position:s});else if(y==="back"){const o=[...c];o[t]={...o[t],position:s},b(o)}},onArtworkDelete:s=>{if(y==="front"){const t=r.filter((o,l)=>l!==s);d(t)}else if(y==="neck")m(null);else if(y==="back"){const t=c.filter((o,l)=>l!==s);b(t)}},view:y})}),e.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 bg-white rounded-full shadow-lg px-2 py-2 flex gap-1",children:[e.jsx("button",{onClick:()=>n("front"),className:`px-5 py-2 rounded-full text-sm font-medium transition-colors ${y==="front"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:"Front"}),e.jsx("button",{onClick:()=>n("back"),className:`px-5 py-2 rounded-full text-sm font-medium transition-colors ${y==="back"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:"Back"}),e.jsx("button",{onClick:()=>n("neck"),className:`px-5 py-2 rounded-full text-sm font-medium transition-colors ${y==="neck"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:"Neck"})]})]}),e.jsx("div",{className:"bg-white border-l border-gray-200 overflow-y-auto",children:e.jsxs("div",{className:"p-5 space-y-1",children:[e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsxs("button",{onClick:()=>De(!ce),className:"w-full flex items-center justify-between mb-4 group",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Garment Color"}),e.jsxs("div",{className:"flex items-center gap-3",children:[x&&e.jsx("span",{className:"w-5 h-5 rounded-full border border-gray-300",style:{backgroundColor:x==="White"?"#FFFFFF":x==="Black"?"#000000":x.toLowerCase()}}),e.jsx("span",{className:"text-gray-400 group-hover:text-gray-600",children:ce?"âˆ’":"+"})]})]}),ce&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-xs text-gray-400 uppercase tracking-wider mb-3",children:"Pre-developed"}),e.jsx("div",{className:"grid grid-cols-2 gap-2.5",children:we.map(s=>e.jsxs("button",{onClick:()=>_(s),className:`flex items-center gap-2.5 p-2.5 rounded-md border transition-all ${x===s?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[e.jsx("div",{className:"w-8 h-8 rounded-full border border-gray-300 flex-shrink-0",style:{backgroundColor:s==="White"?"#FFFFFF":s==="Black"?"#000000":s==="Navy"?"#001f3f":s.toLowerCase()}}),e.jsx("span",{className:"text-xs font-medium",children:s})]},s))})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsxs("button",{onClick:()=>ee(!de),className:"w-full flex items-center justify-between mb-4 group",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Front Artwork"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-black text-white text-xs flex items-center justify-center",children:r.length}),e.jsx("span",{className:"text-gray-400 group-hover:text-gray-600",children:de?"âˆ’":"+"})]})]}),de&&e.jsxs("div",{className:"space-y-4",children:[r.length<4&&e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-md p-6 text-center hover:border-gray-300 transition-colors cursor-pointer",onClick:()=>n("front"),children:[e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/svg+xml,application/pdf",onChange:s=>{n("front"),le(s)},className:"hidden",id:"front-artwork-upload",onClick:s=>s.stopPropagation()}),e.jsxs("label",{htmlFor:"front-artwork-upload",className:"cursor-pointer",children:[e.jsx(xe,{className:"mx-auto mb-2 text-gray-300",size:28}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Upload front artwork (up to 4)"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PNG, JPG, SVG or PDF"})]})]}),r.map((s,t)=>e.jsx("div",{className:"border border-gray-200 rounded-md p-3 bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-white border border-gray-200 rounded flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:s.url,alt:"Front Artwork",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-medium",children:["Artwork ",t+1]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click front view to edit"})]})]}),e.jsx("button",{onClick:()=>{d(r.filter((o,l)=>l!==t))},className:"text-xs text-red-600 hover:text-red-700",children:"Remove"})]})},t))]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsxs("button",{onClick:()=>te(!ue),className:"w-full flex items-center justify-between mb-4 group",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Back Artwork"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-black text-white text-xs flex items-center justify-center",children:c.length}),e.jsx("span",{className:"text-gray-400 group-hover:text-gray-600",children:ue?"âˆ’":"+"})]})]}),ue&&e.jsxs("div",{className:"space-y-4",children:[c.length<4&&e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-md p-6 text-center hover:border-gray-300 transition-colors cursor-pointer",onClick:()=>n("back"),children:[e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/svg+xml,application/pdf",onChange:s=>{n("back"),le(s)},className:"hidden",id:"back-artwork-upload",onClick:s=>s.stopPropagation()}),e.jsxs("label",{htmlFor:"back-artwork-upload",className:"cursor-pointer",children:[e.jsx(xe,{className:"mx-auto mb-2 text-gray-300",size:28}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Upload back artwork (up to 4)"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PNG, JPG, SVG or PDF"})]})]}),c.map((s,t)=>e.jsx("div",{className:"border border-gray-200 rounded-md p-3 bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-white border border-gray-200 rounded flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:s.url,alt:"Back Artwork",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-medium",children:["Artwork ",t+1]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click back view to edit"})]})]}),e.jsx("button",{onClick:()=>{b(c.filter((o,l)=>l!==t))},className:"text-xs text-red-600 hover:text-red-700",children:"Remove"})]})},t))]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsxs("button",{onClick:()=>se(!me),className:"w-full flex items-center justify-between mb-4 group",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Neck Label"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-black text-white text-xs flex items-center justify-center",children:u?"1":"0"}),e.jsx("span",{className:"text-gray-400 group-hover:text-gray-600",children:me?"âˆ’":"+"})]})]}),me&&e.jsxs("div",{className:"space-y-4",children:[!u&&e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-md p-6 text-center hover:border-gray-300 transition-colors cursor-pointer",onClick:()=>n("neck"),children:[e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/svg+xml,application/pdf",onChange:s=>{n("neck"),le(s)},className:"hidden",id:"neck-label-upload",onClick:s=>s.stopPropagation()}),e.jsxs("label",{htmlFor:"neck-label-upload",className:"cursor-pointer",children:[e.jsx(xe,{className:"mx-auto mb-2 text-gray-300",size:28}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Upload neck label"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PNG, JPG, SVG or PDF"})]})]}),u&&e.jsx("div",{className:"border border-gray-200 rounded-md p-3 bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-white border border-gray-200 rounded flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:u.url,alt:"Neck Label",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium",children:"Neck Label"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click neck view to edit"})]})]}),e.jsx("button",{onClick:()=>m(null),className:"text-xs text-red-600 hover:text-red-700",children:"Remove"})]})})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsx("label",{className:"block text-xs font-medium mb-3",children:"Size"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:je.map(s=>e.jsx("button",{onClick:()=>q(s),className:`px-3 py-2 border rounded-md text-xs font-medium transition-all ${N===s?"border-black bg-black text-white":"border-gray-300 hover:border-gray-400"}`,children:s},s))})]}),e.jsx("div",{className:"border-t border-gray-200 pt-5 pb-4",children:e.jsxs("div",{className:`grid ${W>=2?"grid-cols-4":"grid-cols-3"} gap-3`,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",value:W,onChange:s=>K(parseInt(s.target.value)||1),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:border-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Unit cost"}),e.jsxs("div",{className:"text-sm font-semibold",children:["$",B.toFixed(2)]})]}),W>=2&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Total cost"}),e.jsxs("div",{className:"text-sm font-semibold",children:["$",(B*W).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Delivery"}),e.jsx("div",{className:"text-xs font-semibold",children:"4 Nov"})]})]})}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{onClick:Ie,disabled:!x||!N,className:"w-full py-3 bg-black text-white text-sm font-medium rounded-full hover:bg-gray-800 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:L?"Update Cart":"Add to Cart"})})]})})]}),e.jsx(We,{isOpen:f,onClose:()=>S(!1),onSave:be,isUpdating:!!M,currentName:$}),oe&&e.jsx(Ve,{message:Z,type:"success",onClose:()=>V(!1)})]})}function et(){const{slug:I}=Re(),[h,T]=a.useState(null),[F,k]=a.useState(!0),[z]=a.useState(null);return a.useEffect(()=>{if(!I)return;T({product:{id:"1",title:"Classic Cotton T-Shirt",slug:"classic-tee",description:"Premium 100% cotton t-shirt. Soft, comfortable, and perfect for custom designs.",images:["/assets/blank-tshirt.png"],status:"active",variants:[{id:"1",product_id:"1",color:"White",size:"S",sku:"TEE-WHT-S",base_price:12.99,stock_level:100},{id:"2",product_id:"1",color:"White",size:"M",sku:"TEE-WHT-M",base_price:12.99,stock_level:100},{id:"3",product_id:"1",color:"White",size:"L",sku:"TEE-WHT-L",base_price:12.99,stock_level:100},{id:"4",product_id:"1",color:"Black",size:"S",sku:"TEE-BLK-S",base_price:12.99,stock_level:100},{id:"5",product_id:"1",color:"Black",size:"M",sku:"TEE-BLK-M",base_price:12.99,stock_level:100},{id:"6",product_id:"1",color:"Black",size:"L",sku:"TEE-BLK-L",base_price:12.99,stock_level:100},{id:"7",product_id:"1",color:"Navy",size:"S",sku:"TEE-NAV-S",base_price:12.99,stock_level:100},{id:"8",product_id:"1",color:"Navy",size:"M",sku:"TEE-NAV-M",base_price:12.99,stock_level:100},{id:"9",product_id:"1",color:"Navy",size:"L",sku:"TEE-NAV-L",base_price:12.99,stock_level:100}]},decorationMethods:[{id:"1",name:"dtg",display_name:"Direct to Garment",description:"Full-color digital printing",pricing_rules:{base_price:10,per_location:6,quantity_breaks:[{min:1,max:5,multiplier:1},{min:6,max:11,multiplier:.95},{min:12,max:null,multiplier:.85}]},file_requirements:{min_dpi:300,accepted_formats:["png","jpg","pdf"]}}]}),k(!1),Le.getBySlug(I).then(C=>{C&&C.product&&T(C)}).catch(C=>{console.log("Using mock data, API unavailable:",C.message)})},[I]),F?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading product..."})]})}):z||!h?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsx("div",{className:"text-center py-16",children:e.jsx("p",{className:"text-red-600 text-lg",children:z||"Product not found"})})}):e.jsx(He,{product:h.product,variants:h.product.variants,decorationMethods:h.decorationMethods})}export{et as default};
