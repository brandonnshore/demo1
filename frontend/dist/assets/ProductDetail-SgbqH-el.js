import{j as e,u as ge,a as Ee,d as he,b as re,p as Ce}from"./index-DtHRBE8H.js";import{r as o,R as Le,e as Oe,f as De,L as be,h as Pe}from"./react-vendor-Byl6S4M9.js";import{S as Ue,L as ze,I as ke,T as Xe}from"./canvas-vendor-C8lZMoyO.js";import{A as Me,S as Fe,H as He,U as fe,a as We,T as Be}from"./Toast-BUePzcWm.js";import{t as Ge,a as $e}from"./analytics-o4OqUApf.js";import"./auth-vendor-Cg5HAGal.js";const v={CONTAINER_MAX_WIDTH:600,CONTAINER_MAX_HEIGHT:700,ARTWORK_MAX_WIDTH:250,ARTWORK_MAX_HEIGHT:250,ARTWORK_MIN_SIZE:50,ARTWORK_MAX_RESIZE:400,EXPORT_PIXEL_RATIO_HIGH:3,EXPORT_PIXEL_RATIO_MEDIUM:2,EXPORT_PIXEL_RATIO_LOW:1,EXPORT_QUALITY_HIGH:1,EXPORT_QUALITY_MEDIUM:.9,EXPORT_QUALITY_LOW:.8},pe={FRONT:{minX:103,maxX:493,minY:100,maxY:550},BACK:{minX:140,maxX:510,minY:100,maxY:550},NECK:{minX:520,maxX:1080,minY:560,maxY:710}},ve=o.forwardRef(({tshirtColor:a="white",artworks:n=[],onArtworkPositionChange:j,onArtworkDelete:E,view:p="front"},O)=>{const[_,D]=o.useState(null),[F,X]=o.useState([]),[P,L]=o.useState(null),H=o.useRef([]),$=o.useRef(null),x=o.useRef(null),K=o.useRef({front:null,back:null,neck:null}),R=o.useRef("front"),[W,B]=o.useState({width:550,height:650});o.useImperativeHandle(O,()=>({downloadImage:()=>{if(!x.current)return;const c=x.current.toDataURL({pixelRatio:v.EXPORT_PIXEL_RATIO_HIGH,mimeType:"image/png",quality:v.EXPORT_QUALITY_HIGH}),r=document.createElement("a");r.download="tshirt-design.png",r.href=c,document.body.appendChild(r),r.click(),document.body.removeChild(r)},getThumbnail:()=>x.current?x.current.toDataURL({pixelRatio:v.EXPORT_PIXEL_RATIO_LOW,mimeType:"image/png",quality:v.EXPORT_QUALITY_LOW}):null,captureImage:()=>x.current?x.current.toDataURL({pixelRatio:v.EXPORT_PIXEL_RATIO_MEDIUM,mimeType:"image/png",quality:v.EXPORT_QUALITY_MEDIUM}):null,getThumbnailBlob:async()=>{if(!x.current)return null;const c=x.current.toDataURL({pixelRatio:v.EXPORT_PIXEL_RATIO_LOW,mimeType:"image/png",quality:v.EXPORT_QUALITY_LOW});return await(await fetch(c)).blob()}}));const Q=c=>{const r=c.toLowerCase();return r==="navy"?{front:"/assets/navy-front.png",back:"/assets/navy-back.png",neck:"/assets/navy-neck.png"}:r==="black"?{front:"/assets/black-front.png",back:"/assets/black-back.png",neck:"/assets/black-neck.png"}:{front:"/assets/blank-tshirt.png",back:"/assets/back-tshirt.jpeg",neck:"/assets/neck-tshirt.jpeg"}};o.useEffect(()=>{const c=i=>new Promise(l=>{const g=new window.Image;g.src=i,g.crossOrigin="anonymous",g.onload=()=>l(g),g.onerror=()=>l(g)}),r=Q(a);Promise.all([c(r.front),c(r.back),c(r.neck)]).then(([i,l,g])=>{K.current={front:i,back:l,neck:g};const u=p==="neck"?g:p==="back"?l:i;if(p==="neck"){const m=u.width/u.height,w=1600,C=950;let A=w,I=A/m;I<C&&(I=C,A=I*m),B({width:A,height:I})}else{const m=u.width/u.height,w=600,C=700;let A=w,I=w/m;if(I>C&&(I=C,A=C*m),p==="back"){const U=a?.toLowerCase()||"";U==="white"||U===""?(A=A*1.1,I=I*1.1):U==="navy"&&(A=A*1.02,I=I*1.02)}B({width:A,height:I})}D(u)})},[a,p]),o.useEffect(()=>{if(p===R.current)return;const c=K.current,r=p==="neck"?c.neck:p==="back"?c.back:c.front;if(r){if(p==="neck"){const i=r.width/r.height,l=1600,g=950;let u=l,m=u/i;m<g&&(m=g,u=m*i),B({width:u,height:m})}else{const i=r.width/r.height;let l=v.CONTAINER_MAX_WIDTH,g=v.CONTAINER_MAX_WIDTH/i;if(g>v.CONTAINER_MAX_HEIGHT&&(g=v.CONTAINER_MAX_HEIGHT,l=v.CONTAINER_MAX_HEIGHT*i),p==="back"){const u=a?.toLowerCase()||"";u==="white"||u===""?(l=l*1.1,g=g*1.1):u==="navy"&&(l=l*1.02,g=g*1.02)}B({width:l,height:g})}D(r),R.current=p}},[p]),o.useEffect(()=>{const c=r=>{if((r.key==="Delete"||r.key==="Backspace")&&P&&E){const i=parseInt(P.split("-")[1]);isNaN(i)||(E(i),L(null))}};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[P,E]);const G=o.useRef(new Map);o.useEffect(()=>{if(n.length===0){X([]),L(null),H.current=[];return}(async()=>{const r=n.map(i=>{const l=G.current.get(i.url);return l?Promise.resolve(l):new Promise((g,u)=>{const m=new window.Image;m.src=i.url,m.crossOrigin="anonymous",m.onload=()=>{G.current.set(i.url,m),g(m)},m.onerror=u})});try{const i=await Promise.all(r);X(i),H.current=new Array(i.length).fill(null);const l=n[n.length-1];l&&!l.position&&L(`artwork-${n.length-1}`)}catch(i){console.error("Failed to load artworks:",i)}})()},[n]),o.useEffect(()=>{if(P&&$.current){const c=parseInt(P.split("-")[1]),r=H.current[c];r&&($.current.nodes([r]),$.current.getLayer()?.batchDraw())}},[P]);const Z=c=>{const r=H.current[c];r&&j&&j({x:r.x(),y:r.y(),scaleX:r.scaleX(),scaleY:r.scaleY(),rotation:r.rotation()},c)},f=c=>{const r=c.target===c.target.getStage(),i=c.target.image===_;(r||i)&&L(null)};return e.jsx("div",{className:"relative w-full h-full flex items-center justify-center overflow-hidden",children:e.jsxs("div",{className:"relative flex items-center justify-center",style:{transform:typeof window<"u"&&window.innerWidth<640?`scale(${Math.min(window.innerWidth/600,1)})`:"scale(1)",transformOrigin:"center center"},children:[F.length>0&&P&&e.jsx("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 bg-black/80 text-white text-xs px-4 py-2 rounded-full z-10",children:"Drag to move • Corners to resize • Rotate to spin • Click away to finish"}),F.length>0&&!P&&e.jsx("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 bg-gray-800/60 text-white text-xs px-4 py-2 rounded-full z-10",children:"Click artwork to edit position and size"}),e.jsx(Ue,{ref:x,width:W.width,height:W.height,onMouseDown:f,onTouchStart:f,children:e.jsxs(ze,{children:[_&&e.jsx(ke,{image:_,x:0,y:0,width:W.width,height:W.height,onClick:()=>L(null),onTap:()=>L(null),...p==="neck"?{crop:{x:0,y:0,width:_.width,height:_.height}}:{}}),F.map((c,r)=>{const i=n[r];if(!i)return null;const l=c.width/c.height;let g=v.ARTWORK_MAX_WIDTH,u=v.ARTWORK_MAX_WIDTH/l;return u>v.ARTWORK_MAX_HEIGHT&&(u=v.ARTWORK_MAX_HEIGHT,g=v.ARTWORK_MAX_HEIGHT*l),e.jsxs(Le.Fragment,{children:[e.jsx(ke,{ref:m=>{H.current[r]=m},image:c,x:i.position?.x??(p==="neck"?750:200+r*20),y:i.position?.y??(p==="neck"?500:250+r*20),width:g,height:u,scaleX:i.position?.scaleX??1,scaleY:i.position?.scaleY??1,rotation:i.position?.rotation??0,draggable:!0,dragBoundFunc:m=>{const w=p==="neck"?pe.NECK:p==="back"?pe.BACK:pe.FRONT,C=H.current[r];if(!C)return m;const A=C.getClientRect(),I=A.width,U=A.height;let M=m.x,Y=m.y;const z=A.x-C.x(),V=A.y-C.y();return M+z<w.minX&&(M=w.minX-z),M+z+I>w.maxX&&(M=w.maxX-I-z),Y+V<w.minY&&(Y=w.minY-V),Y+V+U>w.maxY&&(Y=w.maxY-U-V),{x:M,y:Y}},onClick:()=>L(`artwork-${r}`),onTap:()=>L(`artwork-${r}`),onDragEnd:()=>Z(r),onTransformEnd:()=>Z(r)}),P===`artwork-${r}`&&e.jsx(Xe,{ref:$,keepRatio:!0,boundBoxFunc:(m,w)=>w.width<v.ARTWORK_MIN_SIZE||w.height<v.ARTWORK_MIN_SIZE||w.width>v.ARTWORK_MAX_RESIZE||w.height>v.ARTWORK_MAX_RESIZE?m:w,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],rotateEnabled:!0,borderStroke:"#000000",borderStrokeWidth:2,anchorSize:12,anchorStroke:"#000000",anchorFill:"#ffffff",anchorCornerRadius:6})]},`artwork-${r}`)})]})})]})})});ve.displayName="TShirtCanvas";const ye=12.98,Ye=5,Ke=1,Ve=(a,n,j,E)=>{let p=E;return[a,n].filter(Boolean).length===2&&(p+=Ye),j&&(p+=Ke),p},we=["S","M","L","XL","2XL","3XL"],ae=4,qe="http://localhost:3001",q=a=>a?a.startsWith("http")?a:`${qe}${a}`:"",Qe=a=>URL.createObjectURL(a),Ne=300,Ze=async(a,n)=>{const j=new DataView(a);try{if(n==="image/png")return Je(j);if(n==="image/jpeg")return et(j)}catch(E){console.error("Error reading DPI:",E)}return null},Je=a=>{let n=8;for(;n<a.byteLength;){const j=a.getUint32(n);if(String.fromCharCode(a.getUint8(n+4),a.getUint8(n+5),a.getUint8(n+6),a.getUint8(n+7))==="pHYs"){const p=a.getUint32(n+8);if(a.getUint8(n+16)===1)return Math.round(p/39.3701)}n+=j+12}return null},et=a=>{let n=2;for(;n<a.byteLength;){if(a.getUint16(n)===65504){const p=a.getUint8(n+11),O=a.getUint16(n+12);if(p===1)return O;if(p===2)return Math.round(O*2.54);break}const E=a.getUint16(n+2);n+=E+2}return null},tt=async a=>{if(a.type!=="image/png"&&a.type!=="image/jpeg")return{valid:!0,dpi:null};const n=await a.arrayBuffer(),j=await Ze(n,a.type);return{valid:!j||j>=Ne,dpi:j}},st=a=>window.confirm(`Warning: This image has a DPI of ${a}, which is below the required ${Ne} DPI for high-quality DTG printing. The print quality may be poor.

Do you want to upload it anyway?`);function rt({product:a,variants:n}){const j=Oe(),E=ge(s=>s.addItem),p=ge(s=>s.updateItem),O=ge(s=>s.getItem),_=o.useRef(null),{isAuthenticated:D}=Ee(),[F]=De(),[X,P]=o.useState(null),[L,H]=o.useState(null),$=o.useRef(null);o.useEffect(()=>{Ge(a.title)},[]);const[x,K]=o.useState(""),[R,W]=o.useState(""),[B,Q]=o.useState(null),[G,Z]=o.useState(1),[f,c]=o.useState("front"),[r,i]=o.useState([]),[l,g]=o.useState(null),[u,m]=o.useState([]),w=()=>f==="front"?r:f==="neck"?l?[l]:[]:f==="back"?u:[],C=w()[0]||null,[A,I]=o.useState(!1),[U,M]=o.useState(""),[Y,z]=o.useState(!1),[V,J]=o.useState(""),ne=Ve(r.length>0,u.length>0,l!==null,ye),oe=[...new Set(n.map(s=>s.color))],je=oe.includes("Navy")?oe:[...oe,"Navy"],_e=[...new Set(n.map(s=>s.size))].sort((s,t)=>we.indexOf(s)-we.indexOf(t));o.useEffect(()=>{if(x&&R){const s=n.find(t=>t.color===x&&t.size===R);Q(s||null)}},[x,R,n]),o.useEffect(()=>{const s=F.get("designId");s&&D&&n.length>0&&$.current!==s&&($.current=s,Ie(s))},[F,D,n]),o.useEffect(()=>{const s=F.get("editCartItem");if(s){const t=O(s);t&&(H(s),K(t.variantColor),W(t.variantSize),Z(t.quantity),t.customization&&(t.customization.frontArtworks&&i(t.customization.frontArtworks),t.customization.backArtworks&&m(t.customization.backArtworks),t.customization.neckArtwork&&g(t.customization.neckArtwork)))}},[F,O]);const Ie=async s=>{try{const t=await he.getById(s);console.log("[LOAD] Full design object:",JSON.stringify(t,null,2)),P(t.id),M(t.name);const h=t.artwork_ids||[],k=t.artwork_urls||{};let b=0;if(t.design_data){if(t.design_data.front&&t.design_data.front.length>0){const d=t.design_data.front.map(T=>{const S=h[b],me=S?q(k[S]):"";return b++,{url:me||"",position:T,assetId:S}});i(d)}if(t.design_data.back&&t.design_data.back.length>0){const d=t.design_data.back.map(T=>{const S=h[b],me=S?q(k[S]):"";return b++,{url:me||"",position:T,assetId:S}});m(d)}if(t.design_data.neck&&t.design_data.neck.length>0){const d=h[b],T=d?q(k[d]):"";g({url:T||"",position:t.design_data.neck[0],assetId:d})}}console.log("[LOAD] Design variant_id:",t.variant_id),console.log("[LOAD] Design variant_color:",t.variant_color),console.log("[LOAD] Design variant_size:",t.variant_size),console.log("[LOAD] Design data color/size:",t.design_data?.selectedColor,t.design_data?.selectedSize);let N=null,y=null;if(t.design_data?.selectedColor){console.log("[LOAD] Using color from design_data (highest priority):",t.design_data.selectedColor),N=t.design_data.selectedColor,y=t.design_data.selectedSize||"M";const d=n.find(T=>T.color===N&&T.size===y);d?(console.log("[LOAD] Found matching variant for design_data color:",d),Q(d)):console.log("[LOAD] No variant found for color:",N,"(UI-only color like Navy)")}else if(t.variant_id){let d=n.find(T=>T.id===t.variant_id);console.log("[LOAD] Found variant by ID:",d),!d&&t.variant_color&&t.variant_size&&(console.log("[LOAD] Variant ID not found, trying color/size lookup:",t.variant_color,t.variant_size),d=n.find(T=>T.color===t.variant_color&&T.size===t.variant_size),console.log("[LOAD] Found variant by color/size:",d)),d?(console.log("[LOAD] Setting color/size/variant from variant:",d.color,d.size),N=d.color,y=d.size,Q(d)):t.variant_color&&(console.log("[LOAD] No variant found, using color from JOIN:",t.variant_color),N=t.variant_color,y=t.variant_size)}N&&(K(N),W(y||"M"))}catch(t){console.error("Error loading design:",t),alert("Failed to load design")}},ie=async s=>{const t=s.target.files?.[0];if(t)try{const{valid:h,dpi:k}=await tt(t);if(!h&&k&&!st(k)){s.target.value="";return}const N={url:Qe(t),position:null,assetId:void 0};if(f==="front")if(r.length<ae){const y=r.length;i([...r,N]),re.uploadFile(t).then(d=>{i(T=>{const S=[...T];return S[y]&&(S[y]={url:q(d.file_url),position:S[y].position,assetId:d.id}),S})}).catch(d=>console.error("Upload failed:",d))}else{alert(`Maximum ${ae} artworks allowed on front view`),s.target.value="";return}else if(f==="neck"){if(l){alert("Only 1 artwork allowed on neck view. Remove existing artwork first."),s.target.value="";return}g(N),re.uploadFile(t).then(y=>{g(d=>({url:q(y.file_url),position:d?.position||null,assetId:y.id}))}).catch(y=>console.error("Upload failed:",y))}else if(f==="back")if(u.length<ae){const y=u.length;m([...u,N]),re.uploadFile(t).then(d=>{m(T=>{const S=[...T];return S[y]&&(S[y]={url:q(d.file_url),position:S[y].position,assetId:d.id}),S})}).catch(d=>console.error("Upload failed:",d))}else{alert(`Maximum ${ae} artworks allowed on back view`),s.target.value="";return}s.target.value=""}catch(h){console.error("File upload failed:",h),alert("Failed to upload file"),s.target.value=""}},Ae=()=>{_.current&&_.current.downloadImage&&_.current.downloadImage()},Te=async()=>{if(!D){j("/login",{state:{from:window.location.pathname+window.location.search}});return}if(X&&U){try{await xe(U),J("Design updated successfully!"),z(!0),setTimeout(()=>z(!1),3e3)}catch(s){console.error("Error updating design:",s),alert("Failed to update design")}return}I(!0)},xe=async s=>{try{const t={front:r.map(b=>b.position),back:u.map(b=>b.position),neck:l?[l.position]:[],selectedColor:x,selectedSize:R||"M"},h=[...r.filter(b=>b.assetId).map(b=>b.assetId),...u.filter(b=>b.assetId).map(b=>b.assetId),...l?.assetId?[l.assetId]:[]];let k="";if(_.current&&_.current.getThumbnailBlob)try{const b=await _.current.getThumbnailBlob();if(b){const N=new File([b],"thumbnail.png",{type:"image/png"});k=(await re.uploadFile(N)).file_url}}catch(b){console.error("Failed to capture thumbnail:",b)}if(X){const b=R||"M",N=B||(x?n.find(y=>y.color===x&&y.size===b):null);console.log("[SAVE] Updating design with variant:",{variantId:N?.id,color:x,size:R,variant:N}),await he.update(X,{name:s,variantId:N?.id,designData:t,artworkIds:h,thumbnailUrl:k}),M(s)}else{const b=R||"M",N=B||(x?n.find(d=>d.color===x&&d.size===b):null);console.log("[SAVE] Saving new design with variant:",{variantId:N?.id,color:x,size:R,variant:N});const y=await he.save({name:s,productId:a.id,variantId:N?.id,designData:t,artworkIds:h,thumbnailUrl:k});P(y.id),M(s),$e(s)}}catch(t){throw console.error("Error saving design:",t),t}},Se=()=>{if(!x||!R){J("Please select a color and size"),z(!0);return}let s;try{_.current&&_.current.captureImage&&(s=_.current.captureImage())}catch(k){console.error("Error capturing mockup:",k)}const t=B||{id:`temp-${x}-${R}`},h={id:L||`${t.id}-${Date.now()}`,variantId:t.id,productTitle:a.title,variantColor:x,variantSize:R,quantity:G,unitPrice:ne,customization:{method:"dtg",frontArtworks:r,backArtworks:u,neckArtwork:l},mockupUrl:s};L?(p(L,h),J("Cart item updated successfully!")):(E(h),J("Added to cart successfully!")),z(!0),setTimeout(()=>{j("/cart")},1500)},[le,Re]=o.useState(!0),[ce,ee]=o.useState(!1),[de,te]=o.useState(!1),[ue,se]=o.useState(!1);return o.useEffect(()=>{f==="neck"?(se(!0),ee(!1),te(!1)):f==="front"?(ee(!0),te(!1),se(!1)):f==="back"&&(te(!0),ee(!1),se(!1))},[f]),e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("div",{className:"border-b border-gray-200 bg-white sticky top-0 z-50",children:e.jsxs("div",{className:"relative px-3 sm:px-6 py-3 sm:py-1.5 flex items-center justify-between",children:[e.jsx("div",{className:"hidden sm:block text-sm font-bold min-w-0",children:a.title}),e.jsx(be,{to:"/",className:"sm:hidden text-sm font-medium text-gray-600 hover:text-gray-900",children:"← Back"}),e.jsx(be,{to:"/",className:"hidden sm:block absolute left-1/2 -translate-x-1/2 text-lg font-bold hover:text-gray-600 transition-colors",children:"Raspberry"}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{onClick:Ae,disabled:!C,title:"Download Design",className:`hidden sm:flex p-2 rounded-md transition-colors ${C?"text-gray-700 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"}`,children:e.jsx(Me,{size:18})}),e.jsxs("button",{onClick:Te,className:"flex items-center gap-1.5 px-3 sm:px-4 py-2 sm:py-1.5 text-xs font-medium rounded-md transition-colors bg-black text-white hover:bg-gray-800",children:[e.jsx(Fe,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:X?"Update":"Save"}),e.jsx("span",{className:"sm:hidden",children:X?"Update":"Save"})]}),e.jsxs("div",{className:"hidden md:block text-sm font-normal whitespace-nowrap",children:["from $",ye.toFixed(2)]})]})]})}),e.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-[1fr_400px] lg:h-[calc(100vh-40px)]",children:[e.jsxs("div",{className:"bg-white flex flex-col relative h-[60vh] lg:h-full overflow-hidden order-1",children:[e.jsx("div",{className:`absolute inset-0 flex items-center justify-center ${f==="neck"?"pt-0 pb-0 px-0":"pt-2 pb-16 lg:pb-16 px-2 sm:px-6"}`,children:a.slug==="classic-hoodie"?e.jsx(He,{ref:_,artworks:w(),view:f,onArtworkPositionChange:(s,t)=>{if(f==="front"){const h=[...r];h[t]={...h[t],position:s},i(h)}else if(f==="neck"&&l)g({...l,position:s});else if(f==="back"){const h=[...u];h[t]={...h[t],position:s},m(h)}},onArtworkDelete:s=>{if(f==="front"){const t=r.filter((h,k)=>k!==s);i(t)}else if(f==="neck")g(null);else if(f==="back"){const t=u.filter((h,k)=>k!==s);m(t)}}}):e.jsx(ve,{ref:_,tshirtColor:x,artworks:w(),view:f,onArtworkPositionChange:(s,t)=>{if(f==="front"){const h=[...r];h[t]={...h[t],position:s},i(h)}else if(f==="neck"&&l)g({...l,position:s});else if(f==="back"){const h=[...u];h[t]={...h[t],position:s},m(h)}},onArtworkDelete:s=>{if(f==="front"){const t=r.filter((h,k)=>k!==s);i(t)}else if(f==="neck")g(null);else if(f==="back"){const t=u.filter((h,k)=>k!==s);m(t)}}})}),e.jsxs("div",{className:"absolute bottom-4 lg:bottom-8 left-1/2 -translate-x-1/2 bg-white rounded-full shadow-lg px-1.5 sm:px-2 py-1.5 sm:py-2 flex gap-1",children:[e.jsx("button",{onClick:()=>c("front"),className:`px-4 sm:px-5 py-2.5 sm:py-2 rounded-full text-sm font-medium transition-colors ${f==="front"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:"Front"}),e.jsx("button",{onClick:()=>c("back"),className:`px-4 sm:px-5 py-2.5 sm:py-2 rounded-full text-sm font-medium transition-colors ${f==="back"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:"Back"}),e.jsx("button",{onClick:()=>c("neck"),className:`px-4 sm:px-5 py-2.5 sm:py-2 rounded-full text-sm font-medium transition-colors ${f==="neck"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:"Neck"})]})]}),e.jsx("div",{className:"bg-white border-t lg:border-t-0 lg:border-l border-gray-200 overflow-y-auto order-2 max-h-[40vh] lg:max-h-none",children:e.jsxs("div",{className:"p-4 sm:p-5 space-y-1 pb-24 lg:pb-5",children:[e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsxs("button",{onClick:()=>Re(!le),className:"w-full flex items-center justify-between mb-4 group",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Garment Color"}),e.jsxs("div",{className:"flex items-center gap-3",children:[x&&e.jsx("span",{className:"w-5 h-5 rounded-full border border-gray-300",style:{backgroundColor:x==="White"?"#FFFFFF":x==="Black"?"#000000":x.toLowerCase()}}),e.jsx("span",{className:"text-gray-400 group-hover:text-gray-600",children:le?"−":"+"})]})]}),le&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-xs text-gray-400 uppercase tracking-wider mb-3",children:"Pre-developed"}),e.jsx("div",{className:"grid grid-cols-2 gap-2.5",children:je.map(s=>e.jsxs("button",{onClick:()=>K(s),className:`flex items-center gap-2.5 p-2.5 rounded-md border transition-all ${x===s?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[e.jsx("div",{className:"w-8 h-8 rounded-full border border-gray-300 flex-shrink-0",style:{backgroundColor:s==="White"?"#FFFFFF":s==="Black"?"#000000":s==="Navy"?"#001f3f":s.toLowerCase()}}),e.jsx("span",{className:"text-xs font-medium",children:s})]},s))})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsxs("button",{onClick:()=>ee(!ce),className:"w-full flex items-center justify-between mb-4 group",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Front Artwork"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-black text-white text-xs flex items-center justify-center",children:r.length}),e.jsx("span",{className:"text-gray-400 group-hover:text-gray-600",children:ce?"−":"+"})]})]}),ce&&e.jsxs("div",{className:"space-y-4",children:[r.length<4&&e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-md p-6 text-center hover:border-gray-300 transition-colors cursor-pointer",onClick:()=>c("front"),children:[e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/svg+xml,application/pdf",onChange:s=>{c("front"),ie(s)},className:"hidden",id:"front-artwork-upload",onClick:s=>s.stopPropagation()}),e.jsxs("label",{htmlFor:"front-artwork-upload",className:"cursor-pointer",children:[e.jsx(fe,{className:"mx-auto mb-2 text-gray-300",size:28}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Upload front artwork (up to 4)"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PNG, JPG, SVG or PDF"})]})]}),r.map((s,t)=>e.jsx("div",{className:"border border-gray-200 rounded-md p-3 bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-white border border-gray-200 rounded flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:s.url,alt:"Front Artwork",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-medium",children:["Artwork ",t+1]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click front view to edit"})]})]}),e.jsx("button",{onClick:()=>{i(r.filter((h,k)=>k!==t))},className:"text-xs text-red-600 hover:text-red-700",children:"Remove"})]})},t))]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsxs("button",{onClick:()=>te(!de),className:"w-full flex items-center justify-between mb-4 group",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Back Artwork"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-black text-white text-xs flex items-center justify-center",children:u.length}),e.jsx("span",{className:"text-gray-400 group-hover:text-gray-600",children:de?"−":"+"})]})]}),de&&e.jsxs("div",{className:"space-y-4",children:[u.length<4&&e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-md p-6 text-center hover:border-gray-300 transition-colors cursor-pointer",onClick:()=>c("back"),children:[e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/svg+xml,application/pdf",onChange:s=>{c("back"),ie(s)},className:"hidden",id:"back-artwork-upload",onClick:s=>s.stopPropagation()}),e.jsxs("label",{htmlFor:"back-artwork-upload",className:"cursor-pointer",children:[e.jsx(fe,{className:"mx-auto mb-2 text-gray-300",size:28}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Upload back artwork (up to 4)"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PNG, JPG, SVG or PDF"})]})]}),u.map((s,t)=>e.jsx("div",{className:"border border-gray-200 rounded-md p-3 bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-white border border-gray-200 rounded flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:s.url,alt:"Back Artwork",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-medium",children:["Artwork ",t+1]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click back view to edit"})]})]}),e.jsx("button",{onClick:()=>{m(u.filter((h,k)=>k!==t))},className:"text-xs text-red-600 hover:text-red-700",children:"Remove"})]})},t))]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsxs("button",{onClick:()=>se(!ue),className:"w-full flex items-center justify-between mb-4 group",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Neck Label"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-black text-white text-xs flex items-center justify-center",children:l?"1":"0"}),e.jsx("span",{className:"text-gray-400 group-hover:text-gray-600",children:ue?"−":"+"})]})]}),ue&&e.jsxs("div",{className:"space-y-4",children:[!l&&e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-md p-6 text-center hover:border-gray-300 transition-colors cursor-pointer",onClick:()=>c("neck"),children:[e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/svg+xml,application/pdf",onChange:s=>{c("neck"),ie(s)},className:"hidden",id:"neck-label-upload",onClick:s=>s.stopPropagation()}),e.jsxs("label",{htmlFor:"neck-label-upload",className:"cursor-pointer",children:[e.jsx(fe,{className:"mx-auto mb-2 text-gray-300",size:28}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Upload neck label"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PNG, JPG, SVG or PDF"})]})]}),l&&e.jsx("div",{className:"border border-gray-200 rounded-md p-3 bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-white border border-gray-200 rounded flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:l.url,alt:"Neck Label",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium",children:"Neck Label"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click neck view to edit"})]})]}),e.jsx("button",{onClick:()=>g(null),className:"text-xs text-red-600 hover:text-red-700",children:"Remove"})]})})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsx("label",{className:"block text-xs font-medium mb-3",children:"Size"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:_e.map(s=>e.jsx("button",{onClick:()=>W(s),className:`px-3 py-2 border rounded-md text-xs font-medium transition-all ${R===s?"border-black bg-black text-white":"border-gray-300 hover:border-gray-400"}`,children:s},s))})]}),e.jsx("div",{className:"border-t border-gray-200 pt-5 pb-4",children:e.jsxs("div",{className:`grid ${G>=2?"grid-cols-4":"grid-cols-3"} gap-3`,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",value:G,onChange:s=>Z(parseInt(s.target.value)||1),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:border-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Unit cost"}),e.jsxs("div",{className:"text-sm font-semibold",children:["$",ne.toFixed(2)]})]}),G>=2&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Total cost"}),e.jsxs("div",{className:"text-sm font-semibold",children:["$",(ne*G).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Delivery"}),e.jsx("div",{className:"text-xs font-semibold",children:"4 Nov"})]})]})}),e.jsx("div",{className:"pt-4 lg:relative fixed bottom-0 left-0 right-0 p-4 bg-white border-t lg:border-t-0 border-gray-200 lg:p-0 shadow-lg lg:shadow-none",children:e.jsx("button",{onClick:Se,disabled:!x||!R,className:"w-full py-3.5 sm:py-3 bg-black text-white text-base sm:text-sm font-medium rounded-full hover:bg-gray-800 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:L?"Update Cart":"Add to Cart"})})]})})]}),e.jsx(We,{isOpen:A,onClose:()=>I(!1),onSave:xe,isUpdating:!!X,currentName:U}),Y&&e.jsx(Be,{message:V,type:"success",onClose:()=>z(!1)})]})}function dt(){const{slug:a}=Pe(),[n,j]=o.useState(null),[E,p]=o.useState(!0),[O]=o.useState(null);return o.useEffect(()=>{if(!a)return;j({product:{id:"1",title:"Classic Cotton T-Shirt",slug:"classic-tee",description:"Premium 100% cotton t-shirt. Soft, comfortable, and perfect for custom designs.",images:["/assets/blank-tshirt.png"],status:"active",variants:[{id:"1",product_id:"1",color:"White",size:"S",sku:"TEE-WHT-S",base_price:12.99,stock_level:100},{id:"2",product_id:"1",color:"White",size:"M",sku:"TEE-WHT-M",base_price:12.99,stock_level:100},{id:"3",product_id:"1",color:"White",size:"L",sku:"TEE-WHT-L",base_price:12.99,stock_level:100},{id:"4",product_id:"1",color:"Black",size:"S",sku:"TEE-BLK-S",base_price:12.99,stock_level:100},{id:"5",product_id:"1",color:"Black",size:"M",sku:"TEE-BLK-M",base_price:12.99,stock_level:100},{id:"6",product_id:"1",color:"Black",size:"L",sku:"TEE-BLK-L",base_price:12.99,stock_level:100},{id:"7",product_id:"1",color:"Navy",size:"S",sku:"TEE-NAV-S",base_price:12.99,stock_level:100},{id:"8",product_id:"1",color:"Navy",size:"M",sku:"TEE-NAV-M",base_price:12.99,stock_level:100},{id:"9",product_id:"1",color:"Navy",size:"L",sku:"TEE-NAV-L",base_price:12.99,stock_level:100}]},decorationMethods:[{id:"1",name:"dtg",display_name:"Direct to Garment",description:"Full-color digital printing",pricing_rules:{base_price:10,per_location:6,quantity_breaks:[{min:1,max:5,multiplier:1},{min:6,max:11,multiplier:.95},{min:12,max:null,multiplier:.85}]},file_requirements:{min_dpi:300,accepted_formats:["png","jpg","pdf"]}}]}),p(!1),Ce.getBySlug(a).then(D=>{D&&D.product&&j(D)}).catch(D=>{console.log("Using mock data, API unavailable:",D.message)})},[a]),E?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading product..."})]})}):O||!n?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsx("div",{className:"text-center py-16",children:e.jsx("p",{className:"text-red-600 text-lg",children:O||"Product not found"})})}):e.jsx(rt,{product:n.product,variants:n.product.variants})}export{dt as default};
