import{s as h,e as m,j as s}from"./index-C3RJHPcl.js";import{r as i}from"./react-vendor-Byl6S4M9.js";import"./auth-vendor-Cg5HAGal.js";function p(){const[r,a]=i.useState("");i.useEffect(()=>{c()},[]);const c=async()=>{try{console.log("[OAuth] Starting callback handler...");const{data:{session:e},error:o}=await h.auth.getSession();if(console.log("[OAuth] Session data:",e),console.log("[OAuth] Session error:",o),o)throw console.error("[OAuth] Session error:",o),o;if(e?.user){const{email:t,user_metadata:n}=e.user,l=n?.full_name||n?.name||t?.split("@")[0]||"User";console.log("[OAuth] User data:",{email:t,name:l,id:e.user.id}),console.log("[OAuth] Calling oauthSync...");const u=await m.oauthSync(t,l,e.user.id);console.log("[OAuth] Sync result:",u);const d=localStorage.getItem("auth_token");console.log("[OAuth] Token in localStorage:",d?"EXISTS":"MISSING"),console.log("[OAuth] Redirecting to dashboard..."),window.location.href="/dashboard"}else console.error("[OAuth] No session found"),a("No session found. Please try again."),setTimeout(()=>window.location.href="/login",2e3)}catch(e){console.error("[OAuth] Callback error:",e),console.error("[OAuth] Error details:",{message:e.message,response:e.response?.data,status:e.response?.status}),a(e.response?.data?.message||e.message||"Authentication failed. Please try again."),setTimeout(()=>window.location.href="/login",2e3)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"text-center",children:r?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"text-red-600 mb-4",children:r}),s.jsx("p",{className:"text-gray-600",children:"Redirecting to login..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-black mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Completing sign in..."})]})})})}export{p as default};
