import{j as e,u as ge,a as Re,d as he,b as re,p as Ee}from"./index-CgNUpRIG.js";import{r as o,R as Ce,e as De,f as Le,L as Oe,h as Pe}from"./react-vendor-Byl6S4M9.js";import{S as Ue,L as Xe,I as be,T as ze}from"./canvas-vendor-C8lZMoyO.js";import{A as Me,S as Fe,H as He,U as fe,a as We,T as Be}from"./Toast-DKzjlPEa.js";import{t as Ge,a as $e}from"./analytics-o4OqUApf.js";import"./auth-vendor-Cg5HAGal.js";import"./x-DNMsmAvo.js";const v={CONTAINER_MAX_WIDTH:600,CONTAINER_MAX_HEIGHT:700,ARTWORK_MAX_WIDTH:250,ARTWORK_MAX_HEIGHT:250,ARTWORK_MIN_SIZE:50,ARTWORK_MAX_RESIZE:400,EXPORT_PIXEL_RATIO_HIGH:3,EXPORT_PIXEL_RATIO_MEDIUM:2,EXPORT_PIXEL_RATIO_LOW:1,EXPORT_QUALITY_HIGH:1,EXPORT_QUALITY_MEDIUM:.9,EXPORT_QUALITY_LOW:.8},pe={FRONT:{minX:80,maxX:470,minY:100,maxY:550},BACK:{minX:140,maxX:510,minY:100,maxY:550},NECK:{minX:520,maxX:1080,minY:560,maxY:710}},we=o.forwardRef(({tshirtColor:a="white",artworks:n=[],onArtworkPositionChange:_,onArtworkDelete:R,view:p="front"},L)=>{const[j,O]=o.useState(null),[z,M]=o.useState([]),[P,D]=o.useState(null),F=o.useRef([]),$=o.useRef(null),x=o.useRef(null),K=o.useRef({front:null,back:null,neck:null}),S=o.useRef("front"),[H,W]=o.useState({width:550,height:650});o.useImperativeHandle(L,()=>({downloadImage:()=>{if(!x.current)return;const c=x.current.toDataURL({pixelRatio:v.EXPORT_PIXEL_RATIO_HIGH,mimeType:"image/png",quality:v.EXPORT_QUALITY_HIGH}),r=document.createElement("a");r.download="tshirt-design.png",r.href=c,document.body.appendChild(r),r.click(),document.body.removeChild(r)},getThumbnail:()=>x.current?x.current.toDataURL({pixelRatio:v.EXPORT_PIXEL_RATIO_LOW,mimeType:"image/png",quality:v.EXPORT_QUALITY_LOW}):null,captureImage:()=>x.current?x.current.toDataURL({pixelRatio:v.EXPORT_PIXEL_RATIO_MEDIUM,mimeType:"image/png",quality:v.EXPORT_QUALITY_MEDIUM}):null,getThumbnailBlob:async()=>{if(!x.current)return null;const c=x.current.toDataURL({pixelRatio:v.EXPORT_PIXEL_RATIO_LOW,mimeType:"image/png",quality:v.EXPORT_QUALITY_LOW});return await(await fetch(c)).blob()}}));const q=c=>{const r=c.toLowerCase();return r==="navy"?{front:"/assets/navy-front.png",back:"/assets/navy-back.png",neck:"/assets/navy-neck.png"}:r==="black"?{front:"/assets/black-front.png",back:"/assets/black-back.png",neck:"/assets/black-neck.png"}:{front:"/assets/blank-tshirt.png",back:"/assets/back-tshirt.jpeg",neck:"/assets/neck-tshirt.jpeg"}};o.useEffect(()=>{const c=i=>new Promise(l=>{const m=new window.Image;m.src=i,m.crossOrigin="anonymous",m.onload=()=>l(m),m.onerror=()=>l(m)}),r=q(a);Promise.all([c(r.front),c(r.back),c(r.neck)]).then(([i,l,m])=>{K.current={front:i,back:l,neck:m};const u=p==="neck"?m:p==="back"?l:i;if(p==="neck"){const g=u.width/u.height,w=1600,E=950;let C=w,I=C/g;I<E&&(I=E,C=I*g),W({width:C,height:I})}else{const g=u.width/u.height,w=600,E=700;let C=w,I=w/g;if(I>E&&(I=E,C=E*g),p==="back"){const X=a?.toLowerCase()||"";X==="white"||X===""?(C=C*1.1,I=I*1.1):X==="navy"&&(C=C*1.02,I=I*1.02)}W({width:C,height:I})}O(u)})},[a,p]),o.useEffect(()=>{if(p===S.current)return;const c=K.current,r=p==="neck"?c.neck:p==="back"?c.back:c.front;if(r){if(p==="neck"){const i=r.width/r.height,l=1600,m=950;let u=l,g=u/i;g<m&&(g=m,u=g*i),W({width:u,height:g})}else{const i=r.width/r.height;let l=v.CONTAINER_MAX_WIDTH,m=v.CONTAINER_MAX_WIDTH/i;if(m>v.CONTAINER_MAX_HEIGHT&&(m=v.CONTAINER_MAX_HEIGHT,l=v.CONTAINER_MAX_HEIGHT*i),p==="back"){const u=a?.toLowerCase()||"";u==="white"||u===""?(l=l*1.1,m=m*1.1):u==="navy"&&(l=l*1.02,m=m*1.02)}W({width:l,height:m})}O(r),S.current=p}},[p]),o.useEffect(()=>{const c=r=>{if((r.key==="Delete"||r.key==="Backspace")&&P&&R){const i=parseInt(P.split("-")[1]);isNaN(i)||(R(i),D(null))}};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[P,R]);const B=o.useRef(new Map);o.useEffect(()=>{if(n.length===0){M([]),D(null),F.current=[];return}(async()=>{const r=n.map(i=>{const l=B.current.get(i.url);return l?Promise.resolve(l):new Promise((m,u)=>{const g=new window.Image;g.src=i.url,g.crossOrigin="anonymous",g.onload=()=>{B.current.set(i.url,g),m(g)},g.onerror=u})});try{const i=await Promise.all(r);M(i),F.current=new Array(i.length).fill(null);const l=n[n.length-1];l&&!l.position&&D(`artwork-${n.length-1}`)}catch(i){console.error("Failed to load artworks:",i)}})()},[n]),o.useEffect(()=>{if(P&&$.current){const c=parseInt(P.split("-")[1]),r=F.current[c];r&&($.current.nodes([r]),$.current.getLayer()?.batchDraw())}},[P]);const Q=c=>{const r=F.current[c];r&&_&&_({x:r.x(),y:r.y(),scaleX:r.scaleX(),scaleY:r.scaleY(),rotation:r.rotation()},c)},f=c=>{const r=c.target===c.target.getStage(),i=c.target.image===j;(r||i)&&D(null)};return e.jsxs("div",{className:"relative w-full h-full flex items-center justify-center overflow-hidden",children:[z.length>0&&P&&e.jsx("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 bg-black/80 text-white text-xs px-4 py-2 rounded-full z-10",children:"Drag to move • Corners to resize • Rotate to spin • Click away to finish"}),z.length>0&&!P&&e.jsx("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 bg-gray-800/60 text-white text-xs px-4 py-2 rounded-full z-10",children:"Click artwork to edit position and size"}),e.jsx(Ue,{ref:x,width:H.width,height:H.height,onMouseDown:f,onTouchStart:f,children:e.jsxs(Xe,{children:[j&&e.jsx(be,{image:j,x:0,y:0,width:H.width,height:H.height,onClick:()=>D(null),onTap:()=>D(null),...p==="neck"?{crop:{x:0,y:0,width:j.width,height:j.height}}:{}}),z.map((c,r)=>{const i=n[r];if(!i)return null;const l=c.width/c.height;let m=v.ARTWORK_MAX_WIDTH,u=v.ARTWORK_MAX_WIDTH/l;return u>v.ARTWORK_MAX_HEIGHT&&(u=v.ARTWORK_MAX_HEIGHT,m=v.ARTWORK_MAX_HEIGHT*l),e.jsxs(Ce.Fragment,{children:[e.jsx(be,{ref:g=>{F.current[r]=g},image:c,x:i.position?.x??(p==="neck"?750:200+r*20),y:i.position?.y??(p==="neck"?500:250+r*20),width:m,height:u,scaleX:i.position?.scaleX??1,scaleY:i.position?.scaleY??1,rotation:i.position?.rotation??0,draggable:!0,dragBoundFunc:g=>{const w=p==="neck"?pe.NECK:p==="back"?pe.BACK:pe.FRONT,E=F.current[r],C=E?.width()||0,I=E?.height()||0,X=E?.scaleX()||1,Z=E?.scaleY()||1,J=C*X,G=I*Z;let Y=g.x,U=g.y;return Y<w.minX&&(Y=w.minX),Y+J>w.maxX&&(Y=w.maxX-J),U<w.minY&&(U=w.minY),U+G>w.maxY&&(U=w.maxY-G),{x:Y,y:U}},onClick:()=>D(`artwork-${r}`),onTap:()=>D(`artwork-${r}`),onDragEnd:()=>Q(r),onTransformEnd:()=>Q(r)}),P===`artwork-${r}`&&e.jsx(ze,{ref:$,keepRatio:!0,boundBoxFunc:(g,w)=>w.width<v.ARTWORK_MIN_SIZE||w.height<v.ARTWORK_MIN_SIZE||w.width>v.ARTWORK_MAX_RESIZE||w.height>v.ARTWORK_MAX_RESIZE?g:w,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],rotateEnabled:!0,borderStroke:"#000000",borderStrokeWidth:2,anchorSize:12,anchorStroke:"#000000",anchorFill:"#ffffff",anchorCornerRadius:6})]},`artwork-${r}`)})]})})]})});we.displayName="TShirtCanvas";const ke=12.98,Ye=5,Ke=1,Ve=(a,n,_,R)=>{let p=R;return[a,n].filter(Boolean).length===2&&(p+=Ye),_&&(p+=Ke),p},ye=["S","M","L","XL","2XL","3XL"],ae=4,qe="http://localhost:3001",V=a=>a?a.startsWith("http")?a:`${qe}${a}`:"",Qe=a=>URL.createObjectURL(a),ve=300,Ze=async(a,n)=>{const _=new DataView(a);try{if(n==="image/png")return Je(_);if(n==="image/jpeg")return et(_)}catch(R){console.error("Error reading DPI:",R)}return null},Je=a=>{let n=8;for(;n<a.byteLength;){const _=a.getUint32(n);if(String.fromCharCode(a.getUint8(n+4),a.getUint8(n+5),a.getUint8(n+6),a.getUint8(n+7))==="pHYs"){const p=a.getUint32(n+8);if(a.getUint8(n+16)===1)return Math.round(p/39.3701)}n+=_+12}return null},et=a=>{let n=2;for(;n<a.byteLength;){if(a.getUint16(n)===65504){const p=a.getUint8(n+11),L=a.getUint16(n+12);if(p===1)return L;if(p===2)return Math.round(L*2.54);break}const R=a.getUint16(n+2);n+=R+2}return null},tt=async a=>{if(a.type!=="image/png"&&a.type!=="image/jpeg")return{valid:!0,dpi:null};const n=await a.arrayBuffer(),_=await Ze(n,a.type);return{valid:!_||_>=ve,dpi:_}},st=a=>window.confirm(`Warning: This image has a DPI of ${a}, which is below the required ${ve} DPI for high-quality DTG printing. The print quality may be poor.

Do you want to upload it anyway?`);function rt({product:a,variants:n}){const _=De(),R=ge(s=>s.addItem),p=ge(s=>s.updateItem),L=ge(s=>s.getItem),j=o.useRef(null),{isAuthenticated:O}=Re(),[z]=Le(),[M,P]=o.useState(null),[D,F]=o.useState(null),$=o.useRef(null);o.useEffect(()=>{Ge(a.title)},[]);const[x,K]=o.useState(""),[S,H]=o.useState(""),[W,q]=o.useState(null),[B,Q]=o.useState(1),[f,c]=o.useState("front"),[r,i]=o.useState([]),[l,m]=o.useState(null),[u,g]=o.useState([]),w=()=>f==="front"?r:f==="neck"?l?[l]:[]:f==="back"?u:[],E=w()[0]||null,[C,I]=o.useState(!1),[X,Z]=o.useState(""),[J,G]=o.useState(!1),[Y,U]=o.useState(""),ne=Ve(r.length>0,u.length>0,l!==null,ke),oe=[...new Set(n.map(s=>s.color))],Ne=oe.includes("Navy")?oe:[...oe,"Navy"],_e=[...new Set(n.map(s=>s.size))].sort((s,t)=>ye.indexOf(s)-ye.indexOf(t));o.useEffect(()=>{if(x&&S){const s=n.find(t=>t.color===x&&t.size===S);q(s||null)}},[x,S,n]),o.useEffect(()=>{const s=z.get("designId");s&&O&&n.length>0&&$.current!==s&&($.current=s,je(s))},[z,O,n]),o.useEffect(()=>{const s=z.get("editCartItem");if(s){const t=L(s);t&&(F(s),K(t.variantColor),H(t.variantSize),Q(t.quantity),t.customization&&(t.customization.frontArtworks&&i(t.customization.frontArtworks),t.customization.backArtworks&&g(t.customization.backArtworks),t.customization.neckArtwork&&m(t.customization.neckArtwork)))}},[z,L]);const je=async s=>{try{const t=await he.getById(s);console.log("[LOAD] Full design object:",JSON.stringify(t,null,2)),P(t.id),Z(t.name);const h=t.artwork_ids||[],k=t.artwork_urls||{};let b=0;if(t.design_data){if(t.design_data.front&&t.design_data.front.length>0){const d=t.design_data.front.map(A=>{const T=h[b],me=T?V(k[T]):"";return b++,{url:me||"",position:A,assetId:T}});i(d)}if(t.design_data.back&&t.design_data.back.length>0){const d=t.design_data.back.map(A=>{const T=h[b],me=T?V(k[T]):"";return b++,{url:me||"",position:A,assetId:T}});g(d)}if(t.design_data.neck&&t.design_data.neck.length>0){const d=h[b],A=d?V(k[d]):"";m({url:A||"",position:t.design_data.neck[0],assetId:d})}}console.log("[LOAD] Design variant_id:",t.variant_id),console.log("[LOAD] Design variant_color:",t.variant_color),console.log("[LOAD] Design variant_size:",t.variant_size),console.log("[LOAD] Design data color/size:",t.design_data?.selectedColor,t.design_data?.selectedSize);let N=null,y=null;if(t.design_data?.selectedColor){console.log("[LOAD] Using color from design_data (highest priority):",t.design_data.selectedColor),N=t.design_data.selectedColor,y=t.design_data.selectedSize||"M";const d=n.find(A=>A.color===N&&A.size===y);d?(console.log("[LOAD] Found matching variant for design_data color:",d),q(d)):console.log("[LOAD] No variant found for color:",N,"(UI-only color like Navy)")}else if(t.variant_id){let d=n.find(A=>A.id===t.variant_id);console.log("[LOAD] Found variant by ID:",d),!d&&t.variant_color&&t.variant_size&&(console.log("[LOAD] Variant ID not found, trying color/size lookup:",t.variant_color,t.variant_size),d=n.find(A=>A.color===t.variant_color&&A.size===t.variant_size),console.log("[LOAD] Found variant by color/size:",d)),d?(console.log("[LOAD] Setting color/size/variant from variant:",d.color,d.size),N=d.color,y=d.size,q(d)):t.variant_color&&(console.log("[LOAD] No variant found, using color from JOIN:",t.variant_color),N=t.variant_color,y=t.variant_size)}N&&(K(N),H(y||"M"))}catch(t){console.error("Error loading design:",t),alert("Failed to load design")}},ie=async s=>{const t=s.target.files?.[0];if(t)try{const{valid:h,dpi:k}=await tt(t);if(!h&&k&&!st(k)){s.target.value="";return}const N={url:Qe(t),position:null,assetId:void 0};if(f==="front")if(r.length<ae){const y=r.length;i([...r,N]),re.uploadFile(t).then(d=>{i(A=>{const T=[...A];return T[y]&&(T[y]={url:V(d.file_url),position:T[y].position,assetId:d.id}),T})}).catch(d=>console.error("Upload failed:",d))}else{alert(`Maximum ${ae} artworks allowed on front view`),s.target.value="";return}else if(f==="neck"){if(l){alert("Only 1 artwork allowed on neck view. Remove existing artwork first."),s.target.value="";return}m(N),re.uploadFile(t).then(y=>{m(d=>({url:V(y.file_url),position:d?.position||null,assetId:y.id}))}).catch(y=>console.error("Upload failed:",y))}else if(f==="back")if(u.length<ae){const y=u.length;g([...u,N]),re.uploadFile(t).then(d=>{g(A=>{const T=[...A];return T[y]&&(T[y]={url:V(d.file_url),position:T[y].position,assetId:d.id}),T})}).catch(d=>console.error("Upload failed:",d))}else{alert(`Maximum ${ae} artworks allowed on back view`),s.target.value="";return}s.target.value=""}catch(h){console.error("File upload failed:",h),alert("Failed to upload file"),s.target.value=""}},Ie=()=>{j.current&&j.current.downloadImage&&j.current.downloadImage()},Ae=async()=>{if(!O){_("/login",{state:{from:window.location.pathname+window.location.search}});return}if(M&&X){try{await xe(X),U("Design updated successfully!"),G(!0),setTimeout(()=>G(!1),3e3)}catch(s){console.error("Error updating design:",s),alert("Failed to update design")}return}I(!0)},xe=async s=>{try{const t={front:r.map(b=>b.position),back:u.map(b=>b.position),neck:l?[l.position]:[],selectedColor:x,selectedSize:S||"M"},h=[...r.filter(b=>b.assetId).map(b=>b.assetId),...u.filter(b=>b.assetId).map(b=>b.assetId),...l?.assetId?[l.assetId]:[]];let k="";if(j.current&&j.current.getThumbnailBlob)try{const b=await j.current.getThumbnailBlob();if(b){const N=new File([b],"thumbnail.png",{type:"image/png"});k=(await re.uploadFile(N)).file_url}}catch(b){console.error("Failed to capture thumbnail:",b)}if(M){const b=S||"M",N=W||(x?n.find(y=>y.color===x&&y.size===b):null);console.log("[SAVE] Updating design with variant:",{variantId:N?.id,color:x,size:S,variant:N}),await he.update(M,{name:s,variantId:N?.id,designData:t,artworkIds:h,thumbnailUrl:k}),Z(s)}else{const b=S||"M",N=W||(x?n.find(d=>d.color===x&&d.size===b):null);console.log("[SAVE] Saving new design with variant:",{variantId:N?.id,color:x,size:S,variant:N});const y=await he.save({name:s,productId:a.id,variantId:N?.id,designData:t,artworkIds:h,thumbnailUrl:k});P(y.id),Z(s),$e(s)}}catch(t){throw console.error("Error saving design:",t),t}},Te=()=>{if(!x||!S){U("Please select a color and size"),G(!0);return}let s;try{j.current&&j.current.captureImage&&(s=j.current.captureImage())}catch(k){console.error("Error capturing mockup:",k)}const t=W||{id:`temp-${x}-${S}`},h={id:D||`${t.id}-${Date.now()}`,variantId:t.id,productTitle:a.title,variantColor:x,variantSize:S,quantity:B,unitPrice:ne,customization:{method:"dtg",frontArtworks:r,backArtworks:u,neckArtwork:l},mockupUrl:s};D?(p(D,h),U("Cart item updated successfully!")):(R(h),U("Added to cart successfully!")),G(!0),setTimeout(()=>{_("/cart")},1500)},[le,Se]=o.useState(!0),[ce,ee]=o.useState(!1),[de,te]=o.useState(!1),[ue,se]=o.useState(!1);return o.useEffect(()=>{f==="neck"?(se(!0),ee(!1),te(!1)):f==="front"?(ee(!0),te(!1),se(!1)):f==="back"&&(te(!0),ee(!1),se(!1))},[f]),e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("div",{className:"border-b border-gray-200 bg-white",children:e.jsxs("div",{className:"relative px-6 py-1.5 flex items-center",children:[e.jsx("h1",{className:"text-sm font-bold",children:a.title}),e.jsx(Oe,{to:"/",className:"absolute left-1/2 -translate-x-1/2 text-lg font-bold hover:text-gray-600 transition-colors",children:"Raspberry"}),e.jsxs("div",{className:"ml-auto flex items-center gap-4",children:[e.jsx("button",{onClick:Ie,disabled:!E,title:"Download Design",className:`p-2 rounded-md transition-colors ${E?"text-gray-700 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"}`,children:e.jsx(Me,{size:18})}),e.jsxs("button",{onClick:Ae,className:"flex items-center gap-1.5 px-4 py-1.5 text-xs font-medium rounded-md transition-colors bg-black text-white hover:bg-gray-800",children:[e.jsx(Fe,{size:14}),M?"Update Design":"Save Design"]}),e.jsxs("div",{className:"text-sm font-normal",children:["from $",ke.toFixed(2)]})]})]})}),e.jsxs("div",{className:"grid lg:grid-cols-[1fr_400px] h-[calc(100vh-40px)]",children:[e.jsxs("div",{className:"bg-white flex flex-col relative h-full overflow-hidden",children:[e.jsx("div",{className:`absolute inset-0 flex items-center justify-center ${f==="neck"?"pt-0 pb-0 px-0":"pt-2 pb-16 px-6"}`,children:a.slug==="classic-hoodie"?e.jsx(He,{ref:j,artworks:w(),view:f,onArtworkPositionChange:(s,t)=>{if(f==="front"){const h=[...r];h[t]={...h[t],position:s},i(h)}else if(f==="neck"&&l)m({...l,position:s});else if(f==="back"){const h=[...u];h[t]={...h[t],position:s},g(h)}},onArtworkDelete:s=>{if(f==="front"){const t=r.filter((h,k)=>k!==s);i(t)}else if(f==="neck")m(null);else if(f==="back"){const t=u.filter((h,k)=>k!==s);g(t)}}}):e.jsx(we,{ref:j,tshirtColor:x,artworks:w(),view:f,onArtworkPositionChange:(s,t)=>{if(f==="front"){const h=[...r];h[t]={...h[t],position:s},i(h)}else if(f==="neck"&&l)m({...l,position:s});else if(f==="back"){const h=[...u];h[t]={...h[t],position:s},g(h)}},onArtworkDelete:s=>{if(f==="front"){const t=r.filter((h,k)=>k!==s);i(t)}else if(f==="neck")m(null);else if(f==="back"){const t=u.filter((h,k)=>k!==s);g(t)}}})}),e.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 bg-white rounded-full shadow-lg px-2 py-2 flex gap-1",children:[e.jsx("button",{onClick:()=>c("front"),className:`px-5 py-2 rounded-full text-sm font-medium transition-colors ${f==="front"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:"Front"}),e.jsx("button",{onClick:()=>c("back"),className:`px-5 py-2 rounded-full text-sm font-medium transition-colors ${f==="back"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:"Back"}),e.jsx("button",{onClick:()=>c("neck"),className:`px-5 py-2 rounded-full text-sm font-medium transition-colors ${f==="neck"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:"Neck"})]})]}),e.jsx("div",{className:"bg-white border-l border-gray-200 overflow-y-auto",children:e.jsxs("div",{className:"p-5 space-y-1",children:[e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsxs("button",{onClick:()=>Se(!le),className:"w-full flex items-center justify-between mb-4 group",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Garment Color"}),e.jsxs("div",{className:"flex items-center gap-3",children:[x&&e.jsx("span",{className:"w-5 h-5 rounded-full border border-gray-300",style:{backgroundColor:x==="White"?"#FFFFFF":x==="Black"?"#000000":x.toLowerCase()}}),e.jsx("span",{className:"text-gray-400 group-hover:text-gray-600",children:le?"−":"+"})]})]}),le&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-xs text-gray-400 uppercase tracking-wider mb-3",children:"Pre-developed"}),e.jsx("div",{className:"grid grid-cols-2 gap-2.5",children:Ne.map(s=>e.jsxs("button",{onClick:()=>K(s),className:`flex items-center gap-2.5 p-2.5 rounded-md border transition-all ${x===s?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[e.jsx("div",{className:"w-8 h-8 rounded-full border border-gray-300 flex-shrink-0",style:{backgroundColor:s==="White"?"#FFFFFF":s==="Black"?"#000000":s==="Navy"?"#001f3f":s.toLowerCase()}}),e.jsx("span",{className:"text-xs font-medium",children:s})]},s))})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsxs("button",{onClick:()=>ee(!ce),className:"w-full flex items-center justify-between mb-4 group",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Front Artwork"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-black text-white text-xs flex items-center justify-center",children:r.length}),e.jsx("span",{className:"text-gray-400 group-hover:text-gray-600",children:ce?"−":"+"})]})]}),ce&&e.jsxs("div",{className:"space-y-4",children:[r.length<4&&e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-md p-6 text-center hover:border-gray-300 transition-colors cursor-pointer",onClick:()=>c("front"),children:[e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/svg+xml,application/pdf",onChange:s=>{c("front"),ie(s)},className:"hidden",id:"front-artwork-upload",onClick:s=>s.stopPropagation()}),e.jsxs("label",{htmlFor:"front-artwork-upload",className:"cursor-pointer",children:[e.jsx(fe,{className:"mx-auto mb-2 text-gray-300",size:28}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Upload front artwork (up to 4)"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PNG, JPG, SVG or PDF"})]})]}),r.map((s,t)=>e.jsx("div",{className:"border border-gray-200 rounded-md p-3 bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-white border border-gray-200 rounded flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:s.url,alt:"Front Artwork",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-medium",children:["Artwork ",t+1]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click front view to edit"})]})]}),e.jsx("button",{onClick:()=>{i(r.filter((h,k)=>k!==t))},className:"text-xs text-red-600 hover:text-red-700",children:"Remove"})]})},t))]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsxs("button",{onClick:()=>te(!de),className:"w-full flex items-center justify-between mb-4 group",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Back Artwork"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-black text-white text-xs flex items-center justify-center",children:u.length}),e.jsx("span",{className:"text-gray-400 group-hover:text-gray-600",children:de?"−":"+"})]})]}),de&&e.jsxs("div",{className:"space-y-4",children:[u.length<4&&e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-md p-6 text-center hover:border-gray-300 transition-colors cursor-pointer",onClick:()=>c("back"),children:[e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/svg+xml,application/pdf",onChange:s=>{c("back"),ie(s)},className:"hidden",id:"back-artwork-upload",onClick:s=>s.stopPropagation()}),e.jsxs("label",{htmlFor:"back-artwork-upload",className:"cursor-pointer",children:[e.jsx(fe,{className:"mx-auto mb-2 text-gray-300",size:28}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Upload back artwork (up to 4)"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PNG, JPG, SVG or PDF"})]})]}),u.map((s,t)=>e.jsx("div",{className:"border border-gray-200 rounded-md p-3 bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-white border border-gray-200 rounded flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:s.url,alt:"Back Artwork",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-medium",children:["Artwork ",t+1]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click back view to edit"})]})]}),e.jsx("button",{onClick:()=>{g(u.filter((h,k)=>k!==t))},className:"text-xs text-red-600 hover:text-red-700",children:"Remove"})]})},t))]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsxs("button",{onClick:()=>se(!ue),className:"w-full flex items-center justify-between mb-4 group",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Neck Label"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-black text-white text-xs flex items-center justify-center",children:l?"1":"0"}),e.jsx("span",{className:"text-gray-400 group-hover:text-gray-600",children:ue?"−":"+"})]})]}),ue&&e.jsxs("div",{className:"space-y-4",children:[!l&&e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-md p-6 text-center hover:border-gray-300 transition-colors cursor-pointer",onClick:()=>c("neck"),children:[e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/svg+xml,application/pdf",onChange:s=>{c("neck"),ie(s)},className:"hidden",id:"neck-label-upload",onClick:s=>s.stopPropagation()}),e.jsxs("label",{htmlFor:"neck-label-upload",className:"cursor-pointer",children:[e.jsx(fe,{className:"mx-auto mb-2 text-gray-300",size:28}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Upload neck label"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PNG, JPG, SVG or PDF"})]})]}),l&&e.jsx("div",{className:"border border-gray-200 rounded-md p-3 bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-white border border-gray-200 rounded flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:l.url,alt:"Neck Label",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium",children:"Neck Label"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click neck view to edit"})]})]}),e.jsx("button",{onClick:()=>m(null),className:"text-xs text-red-600 hover:text-red-700",children:"Remove"})]})})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-5 pb-4",children:[e.jsx("label",{className:"block text-xs font-medium mb-3",children:"Size"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:_e.map(s=>e.jsx("button",{onClick:()=>H(s),className:`px-3 py-2 border rounded-md text-xs font-medium transition-all ${S===s?"border-black bg-black text-white":"border-gray-300 hover:border-gray-400"}`,children:s},s))})]}),e.jsx("div",{className:"border-t border-gray-200 pt-5 pb-4",children:e.jsxs("div",{className:`grid ${B>=2?"grid-cols-4":"grid-cols-3"} gap-3`,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",value:B,onChange:s=>Q(parseInt(s.target.value)||1),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:border-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Unit cost"}),e.jsxs("div",{className:"text-sm font-semibold",children:["$",ne.toFixed(2)]})]}),B>=2&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Total cost"}),e.jsxs("div",{className:"text-sm font-semibold",children:["$",(ne*B).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Delivery"}),e.jsx("div",{className:"text-xs font-semibold",children:"4 Nov"})]})]})}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{onClick:Te,disabled:!x||!S,className:"w-full py-3 bg-black text-white text-sm font-medium rounded-full hover:bg-gray-800 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:D?"Update Cart":"Add to Cart"})})]})})]}),e.jsx(We,{isOpen:C,onClose:()=>I(!1),onSave:xe,isUpdating:!!M,currentName:X}),J&&e.jsx(Be,{message:Y,type:"success",onClose:()=>G(!1)})]})}function ut(){const{slug:a}=Pe(),[n,_]=o.useState(null),[R,p]=o.useState(!0),[L]=o.useState(null);return o.useEffect(()=>{if(!a)return;_({product:{id:"1",title:"Classic Cotton T-Shirt",slug:"classic-tee",description:"Premium 100% cotton t-shirt. Soft, comfortable, and perfect for custom designs.",images:["/assets/blank-tshirt.png"],status:"active",variants:[{id:"1",product_id:"1",color:"White",size:"S",sku:"TEE-WHT-S",base_price:12.99,stock_level:100},{id:"2",product_id:"1",color:"White",size:"M",sku:"TEE-WHT-M",base_price:12.99,stock_level:100},{id:"3",product_id:"1",color:"White",size:"L",sku:"TEE-WHT-L",base_price:12.99,stock_level:100},{id:"4",product_id:"1",color:"Black",size:"S",sku:"TEE-BLK-S",base_price:12.99,stock_level:100},{id:"5",product_id:"1",color:"Black",size:"M",sku:"TEE-BLK-M",base_price:12.99,stock_level:100},{id:"6",product_id:"1",color:"Black",size:"L",sku:"TEE-BLK-L",base_price:12.99,stock_level:100},{id:"7",product_id:"1",color:"Navy",size:"S",sku:"TEE-NAV-S",base_price:12.99,stock_level:100},{id:"8",product_id:"1",color:"Navy",size:"M",sku:"TEE-NAV-M",base_price:12.99,stock_level:100},{id:"9",product_id:"1",color:"Navy",size:"L",sku:"TEE-NAV-L",base_price:12.99,stock_level:100}]},decorationMethods:[{id:"1",name:"dtg",display_name:"Direct to Garment",description:"Full-color digital printing",pricing_rules:{base_price:10,per_location:6,quantity_breaks:[{min:1,max:5,multiplier:1},{min:6,max:11,multiplier:.95},{min:12,max:null,multiplier:.85}]},file_requirements:{min_dpi:300,accepted_formats:["png","jpg","pdf"]}}]}),p(!1),Ee.getBySlug(a).then(O=>{O&&O.product&&_(O)}).catch(O=>{console.log("Using mock data, API unavailable:",O.message)})},[a]),R?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading product..."})]})}):L||!n?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsx("div",{className:"text-center py-16",children:e.jsx("p",{className:"text-red-600 text-lg",children:L||"Product not found"})})}):e.jsx(rt,{product:n.product,variants:n.product.variants})}export{ut as default};
